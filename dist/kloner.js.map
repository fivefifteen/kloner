{"version":3,"file":"kloner.js","sources":["../src/kloner.js"],"sourcesContent":["/*!\n  kloner v0.0.2 (https://kloner.js.org)\n  by Kodie Grantham (https://kodieg.com)\n*/\n\nconst kloner = (containerSelector, childSelector, options) => {\n  if (childSelector && childSelector.constructor === Object) {\n    options = childSelector\n    childSelector = null\n  }\n\n  if (containerSelector && containerSelector.constructor === Object) {\n    options = containerSelector\n    containerSelector = null\n  }\n\n  options = Object.assign({}, kloner.defaultOptions, options || {})\n\n  if (containerSelector) {\n    options.containerSelector = containerSelector\n  }\n\n  if (childSelector) {\n    options.childSelector = childSelector\n  }\n\n  const containers = kloner.getInstances(options.containerSelector)\n\n  if (containers && containers.length) {\n    for (let i = 0; i < containers.length; i++) {\n      (function (container) {\n        const funcs = {\n          add: function (atIndex, options) {\n            return kloner.add(container, atIndex, options)\n          },\n          remove: function (atIndex, options) {\n            return kloner.remove(container, atIndex, options)\n          }\n        }\n\n        const opts = Object.assign({}, options, kloner.getAttributeOptions(container), funcs)\n        let data = {} // eslint-disable-line prefer-const\n\n        if (opts.template) {\n          const templateContainer = document.createElement(null)\n\n          templateContainer.innerHTML = opts.template\n\n          const templateElement = templateContainer.firstElementChild\n          const template = templateElement.cloneNode(true)\n\n          data.template = template\n          data.templateIndex = 0\n\n          templateContainer.remove()\n        } else {\n          const templateElement = container.querySelector(opts.childSelector)\n\n          if (!templateElement) {\n            console.warn('[kloner] No template found:', opts.childSelector)\n            return\n          }\n\n          const template = templateElement.cloneNode(true)\n\n          data.template = template\n          data.templateIndex = Array.prototype.indexOf.call(container.children, templateElement)\n\n          if (templateElement.matches('[data-kloner-template]')) {\n            templateElement.remove()\n          }\n        }\n\n        const existingChildren = container.querySelectorAll(opts.childSelector)\n        const count = existingChildren.length\n\n        for (let j = 0; j < count; j++) {\n          kloner.replaceParameters(existingChildren[j], Object.assign({}, opts.parameters || {}, {\n            index: j,\n            number: (j + 1)\n          }))\n        }\n\n        data.count = count\n        data.constCount = count\n        container.kloner = opts\n        container.klonerData = data\n\n        kloner.initializeTriggers(container)\n\n        if (opts.start) {\n          let extraChildren = opts.start\n\n          if (!Array.isArray(extraChildren) && Number.isInteger(parseInt(extraChildren))) {\n            extraChildren = Array((parseInt(extraChildren) - container.klonerData.count) || 0).fill({})\n          }\n\n          if (Array.isArray(extraChildren)) {\n            extraChildren.forEach(childParameters => {\n              opts.add(null, { parameters: childParameters })\n            })\n          }\n        }\n\n        if (opts.min && container.klonerData.count < parseInt(opts.min)) {\n          for (let k = 0; k < (parseInt(opts.min) - container.klonerData.count); k++) {\n            opts.add()\n          }\n        }\n\n        if (opts.max && container.klonerData.count > parseInt(opts.max)) {\n          for (let l = 0; l < (container.klonerData.count - parseInt(opts.max)); l++) {\n            opts.remove()\n          }\n        }\n      })(containers[i])\n    }\n  }\n\n  if (containers.length) {\n    if (containers.length === 1) {\n      return containers[0]\n    }\n\n    return containers\n  }\n\n  return false\n}\n\nkloner.add = (containerSelector, atIndex, options) => {\n  if (atIndex && atIndex.constructor === Object) {\n    options = atIndex\n    atIndex = null\n  }\n\n  if (containerSelector && containerSelector.constructor === Object) {\n    options = containerSelector\n    containerSelector = null\n  }\n\n  if (!containerSelector) containerSelector = kloner.defaultOptions.containerSelector\n\n  const containers = kloner.getInstances(containerSelector, true)\n\n  if (containers && containers.length) {\n    for (let i = 0; i < containers.length; i++) {\n      (function (container) {\n        const opts = Object.assign({}, container.kloner, kloner.getAttributeOptions(container), options)\n        const count = container.klonerData.count\n        const elementCount = opts.updateChildren ? count : container.klonerData.constCount\n\n        if (opts.max && count >= parseInt(opts.max)) {\n          return\n        }\n\n        const elements = container.querySelectorAll(opts.childSelector)\n        const element = container.klonerData.template.cloneNode(true)\n\n        kloner.replaceParameters(element, Object.assign({}, opts.parameters || {}, {\n          index: elementCount,\n          number: (elementCount + 1)\n        }))\n\n        if (opts.beforeAdd && opts.beforeAdd(container, element, opts) === false) {\n          return false\n        }\n\n        const elementIndex = atIndex ?? elements.length ?? container.klonerData.templateIndex\n\n        if (elementIndex) {\n          if (elementIndex >= container.children.length) {\n            container.append(element)\n          } else {\n            container.insertBefore(\n              element,\n              container.children[elementIndex]\n            )\n          }\n        } else {\n          container.prepend(element)\n        }\n\n        container.klonerData.count++\n        container.klonerData.constCount++\n\n        if (opts.updateChildren) {\n          kloner.updateChildren(container)\n        }\n\n        kloner.initializeTriggers(container)\n\n        if (opts.afterAdd) {\n          opts.afterAdd(container, element, opts)\n        }\n      })(containers[i])\n    }\n  }\n}\n\nkloner.defaultOptions = {\n  afterAdd: null,\n  afterChildUpdate: null,\n  afterRemove: null,\n  beforeAdd: null,\n  beforeChildUpdate: null,\n  beforeRemove: null,\n  childSelector: '[data-kloner-template], :scope > *',\n  containerSelector: '[data-kloner], .kloner',\n  max: null,\n  min: 0,\n  parameters: null,\n  start: 0,\n  template: null,\n  updateChildren: false\n}\n\nkloner.getAttributeOptions = (containerSelector) => {\n  if (!containerSelector) containerSelector = kloner.defaultOptions.containerSelector\n\n  const container = kloner.getInstances(containerSelector, false, true)\n\n  if (container) {\n    const data = Object.assign({}, container.dataset)\n    const regexp = /kloner([A-Z].*)/\n\n    return Object.keys(data)\n      .filter(key => regexp.test(key))\n      .reduce((obj, key) => {\n        const match = key.match(regexp)\n        const newKey = match[1][0].toLowerCase() + match[1].slice(1)\n        obj[newKey] = data[key]\n        return obj\n      }, {})\n  }\n\n  return {}\n}\n\nkloner.getInstances = (elements, verify, single) => {\n  if (typeof elements === 'string') {\n    elements = document.querySelectorAll(elements)\n  } else if (elements instanceof HTMLElement) {\n    elements = [elements]\n  }\n\n  if (verify) {\n    let verifiedElements = [] // eslint-disable-line prefer-const\n\n    for (let i = 0; i < elements.length; i++) {\n      (function (container) {\n        if (!container.kloner) {\n          console.warn('Element doesn\\'t appear to be a kloner instance:', container)\n          return\n        }\n\n        verifiedElements.push(container)\n      })(elements[i])\n    }\n\n    return verifiedElements\n  }\n\n  if (elements.length && single) {\n    return elements[0]\n  }\n\n  return elements\n}\n\nkloner.initializeTriggers = (containerSelector) => {\n  if (!containerSelector) containerSelector = kloner.defaultOptions.containerSelector\n\n  const containers = kloner.getInstances(containerSelector, true)\n\n  if (containers && containers.length) {\n    for (let i = 0; i < containers.length; i++) {\n      (function (container) {\n        let addElements = container.querySelectorAll('[data-kloner-add]')\n\n        if (container.id) {\n          addElements = Array.prototype.slice.call(addElements).concat(\n            Array.prototype.slice.call(\n              document.querySelectorAll('[data-kloner-add=\"' + container.id + '\"]')\n            )\n          )\n        }\n\n        if (addElements.length) {\n          for (let j = 0; j < addElements.length; j++) {\n            if (!addElements[j].klonerData || !addElements[j].klonerData.trigger) {\n              addElements[j].addEventListener('click', function (e) {\n                let atIndex = null\n\n                if (!addElements[j].dataset.klonerAdd.length) {\n                  const child = addElements[j].closest(container.kloner.childSelector)\n\n                  if (child) {\n                    atIndex = Array.prototype.indexOf.call(container.children, child)\n                  }\n                }\n\n                container.kloner.add(atIndex, kloner.getAttributeOptions(addElements[j]))\n              })\n\n              if (!addElements[j].klonerData) {\n                addElements[j].klonerData = {}\n              }\n\n              addElements[j].klonerData.trigger = true\n            }\n          }\n        }\n\n        let removeElements = container.querySelectorAll('[data-kloner-remove]')\n\n        if (container.id) {\n          removeElements = Array.prototype.slice.call(removeElements).concat(\n            Array.prototype.slice.call(\n              document.querySelectorAll('[data-kloner-remove=\"' + container.id + '\"]')\n            )\n          )\n        }\n\n        if (removeElements.length) {\n          for (let k = 0; k < removeElements.length; k++) {\n            if (!removeElements[k].klonerData || !removeElements[k].klonerData.trigger) {\n              removeElements[k].addEventListener('click', function (e) {\n                let atIndex = null\n\n                if (!removeElements[k].dataset.klonerRemove.length) {\n                  const child = removeElements[k].closest(container.kloner.childSelector)\n\n                  if (child) {\n                    atIndex = Array.prototype.indexOf.call(container.children, child)\n                  }\n                }\n\n                container.kloner.remove(atIndex, kloner.getAttributeOptions(removeElements[k]))\n              })\n\n              if (!removeElements[k].klonerData) {\n                removeElements[k].klonerData = {}\n              }\n\n              removeElements[k].klonerData.trigger = true\n            }\n          }\n        }\n\n        let countElements = container.querySelectorAll('[data-kloner-count]')\n\n        if (container.id) {\n          countElements = Array.prototype.slice.call(countElements).concat(\n            Array.prototype.slice.call(\n              document.querySelectorAll('[data-kloner-count=\"' + container.id + '\"]')\n            )\n          )\n        }\n\n        if (countElements.length) {\n          for (let l = 0; l < countElements.length; l++) {\n            countElements[l].textContent = container.klonerData.count\n          }\n        }\n      })(containers[i])\n    }\n  }\n}\n\nkloner.remove = (containerSelector, atIndex, options) => {\n  if (atIndex && atIndex.constructor === Object) {\n    options = atIndex\n    atIndex = null\n  }\n\n  if (containerSelector && containerSelector.constructor === Object) {\n    options = containerSelector\n    containerSelector = null\n  }\n\n  if (!containerSelector) containerSelector = kloner.defaultOptions.containerSelector\n\n  const containers = kloner.getInstances(containerSelector, true)\n\n  if (containers && containers.length) {\n    for (let i = 0; i < containers.length; i++) {\n      (function (container) {\n        const opts = Object.assign({}, container.kloner, kloner.getAttributeOptions(container), options)\n        const count = container.klonerData.count\n\n        if (count <= 0 || (opts.min && count <= parseInt(opts.min))) {\n          return\n        }\n\n        const elements = container.querySelectorAll(opts.childSelector)\n        const indexLimit = (elements.length - 1)\n        let elementIndex = atIndex ?? indexLimit\n\n        if (elementIndex > indexLimit) {\n          elementIndex = indexLimit\n        }\n\n        const element = elements[elementIndex]\n\n        if (opts.beforeRemove && opts.beforeRemove(container, element, opts) === false) {\n          return false\n        }\n\n        element.remove()\n\n        container.klonerData.count--\n\n        if (opts.updateChildren) {\n          kloner.updateChildren(container)\n        }\n\n        kloner.initializeTriggers(container)\n\n        if (opts.afterRemove) {\n          opts.afterRemove(container, element, opts)\n        }\n      })(containers[i])\n    }\n  }\n}\n\nkloner.replaceParameters = (element, parameters) => {\n  if (!element.klonerData) {\n    element.klonerData = {}\n  }\n\n  if (!element.klonerData.initialContent) {\n    element.klonerData.initialContent = element.innerHTML\n  }\n\n  element.klonerData.parameters = Object.assign({}, element.klonerData.parameters, parameters || {})\n\n  element.innerHTML = element.klonerData.initialContent\n    .replaceAll(/\\{kloner-(\\w+)\\}/g, (match, key) => element.klonerData.parameters[key] ?? match)\n}\n\nkloner.updateChildren = (containerSelector) => {\n  if (!containerSelector) containerSelector = kloner.defaultOptions.containerSelector\n\n  const containers = kloner.getInstances(containerSelector, true)\n\n  if (containers && containers.length) {\n    for (let i = 0; i < containers.length; i++) {\n      (function (container) {\n        const opts = container.kloner\n        const elements = container.querySelectorAll(opts.childSelector)\n\n        if (elements) {\n          for (let j = 0; j < elements.length; j++) {\n            const element = elements[j]\n\n            if (opts.beforeChildUpdate && opts.beforeChildUpdate(container, element, opts) === false) {\n              continue\n            }\n\n            kloner.replaceParameters(element, {\n              index: j,\n              number: (j + 1)\n            })\n\n            if (opts.afterChildUpdate) {\n              opts.afterChildUpdate(container, element, opts)\n            }\n          }\n        }\n      })(containers[i])\n    }\n  }\n}\n\nexport default kloner\n"],"names":["kloner","containerSelector","childSelector","options","constructor","Object","assign","defaultOptions","containers","getInstances","length","i","container","funcs","add","atIndex","remove","opts","getAttributeOptions","data","template","templateContainer","document","createElement","innerHTML","templateElement","firstElementChild","cloneNode","templateIndex","querySelector","console","warn","Array","prototype","indexOf","call","children","matches","existingChildren","querySelectorAll","count","j","replaceParameters","parameters","index","number","constCount","klonerData","initializeTriggers","start","extraChildren","isArray","Number","isInteger","parseInt","fill","forEach","childParameters","min","k","max","l","_ref","_atIndex","elementCount","updateChildren","elements","element","beforeAdd","elementIndex","append","insertBefore","prepend","afterAdd","afterChildUpdate","afterRemove","beforeChildUpdate","beforeRemove","dataset","regexp","keys","filter","key","test","reduce","obj","match","newKey","toLowerCase","slice","verify","single","HTMLElement","verifiedElements","push","addElements","id","concat","_loop","trigger","addEventListener","e","klonerAdd","child","closest","removeElements","_loop2","klonerRemove","countElements","textContent","_atIndex2","indexLimit","initialContent","replaceAll","_element$klonerData$p"],"mappings":"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"}